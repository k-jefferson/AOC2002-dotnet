namespace AocModel;

public class Day4
{
    public IEnumerable<ElvesPair> Pairs { get; private set; }

    public Day4()
    {
        Pairs =
            inputs
            .Split("\n")
            .Select(ParseElvesPair);
    }

    public int SolvePart1()
        => Pairs.Count(PairsFullyOverlaps);

    public int SolvePart2()
        => Pairs.Count(PairsHasAnyOverlap);

    #region Part1
    public bool PairsFullyOverlaps(ElvesPair pair)
        => IntervalAContainsB(pair.Elve1, pair.Elve2) || IntervalAContainsB(pair.Elve2, pair.Elve1);

    public bool IntervalAContainsB(CampSection A, CampSection B)
        => A.Start <= B.Start && A.End >= B.End;
    #endregion

    #region Part2
    public static bool PairsHasAnyOverlap(ElvesPair pair)
        => IntervalAIntersectsB(pair.Elve1, pair.Elve2);

    public static bool IntervalAIntersectsB(CampSection A, CampSection B)
        => A.Start <= B.End && B.Start <= A.End;
    #endregion

    #region Parsing
    public static ElvesPair? ParseElvesPair(string s)
        => s?.Split(",") is string[] arr &&
                arr.Count() == 2 &&
                ParseCampSection(arr[0]) is CampSection section1 &&
                ParseCampSection(arr[1]) is CampSection section2 ?
                new ElvesPair { Elve1 = section1, Elve2 = section2 } :
                null;

    public static CampSection? ParseCampSection(string s)
        => s?.Split("-") is string[] arr &&
                arr.Count() == 2 &&
                int.TryParse(arr[0], out int start) &&
                int.TryParse(arr[1], out int end) ?
                new CampSection { Start = start, End = end } :
                null;
    #endregion

    public class ElvesPair
    {
        public CampSection Elve1;
        public CampSection Elve2;
    }

    public class CampSection
    {
        public int Start;
        public int End;
    }

    public const string inputs = $"14-28,13-28\n72-81,82-91\n4-4,6-95\n47-49,48-59\n26-36,37-76\n2-99,98-99\n26-36,19-35\n85-85,13-84\n14-94,15-95\n26-89,16-27\n84-89,29-88\n2-61,1-60\n80-92,2-81\n35-47,19-36\n68-70,69-86\n59-97,12-92\n56-65,12-49\n18-18,18-55\n7-98,7-98\n61-94,32-93\n88-98,2-96\n39-39,44-84\n62-62,62-83\n7-30,8-60\n47-90,46-64\n22-73,21-41\n15-78,14-14\n52-72,53-98\n83-85,68-84\n61-73,63-74\n8-9,9-94\n5-97,46-98\n35-99,3-94\n68-95,67-83\n41-55,56-56\n10-90,9-11\n14-48,14-47\n57-65,64-93\n33-51,33-50\n15-79,13-16\n38-41,39-42\n1-15,6-16\n6-96,81-98\n32-42,35-43\n20-52,9-51\n5-67,66-68\n56-56,2-55\n13-59,14-60\n10-86,9-86\n4-45,5-46\n76-80,75-79\n1-98,1-97\n23-48,15-45\n8-21,20-99\n20-68,21-86\n21-28,22-27\n25-42,15-26\n5-88,98-99\n5-56,14-34\n98-99,33-99\n2-84,83-98\n43-69,42-67\n3-3,3-62\n72-83,74-84\n10-12,11-91\n19-74,53-75\n10-98,9-99\n30-96,29-30\n32-68,67-83\n24-33,32-92\n29-60,30-61\n12-19,14-39\n34-96,95-97\n15-18,14-89\n44-50,45-53\n78-81,2-78\n7-89,71-90\n5-36,27-44\n2-95,9-96\n4-63,3-98\n10-57,9-56\n42-91,41-60\n30-75,82-99\n56-98,99-99\n7-45,45-46\n32-95,31-89\n99-99,2-97\n60-98,24-98\n2-69,70-86\n74-97,7-98\n4-68,5-63\n27-65,7-83\n1-74,62-76\n24-65,25-78\n15-98,20-95\n8-50,49-82\n98-99,20-98\n3-89,6-90\n66-85,66-86\n64-96,63-63\n3-19,1-81\n7-94,93-95\n45-88,95-96\n7-12,11-83\n35-70,34-71\n3-98,2-2\n41-92,40-42\n2-94,1-1\n75-97,78-96\n46-68,68-91\n34-35,33-48\n97-97,68-95\n73-73,31-72\n18-61,17-60\n8-95,9-96\n9-64,29-67\n68-70,32-82\n34-66,34-65\n48-97,96-96\n4-81,3-48\n12-80,8-13\n10-33,11-34\n31-74,20-54\n47-97,46-67\n42-99,43-98\n75-75,50-74\n6-95,2-5\n2-96,3-95\n15-60,45-61\n7-52,7-52\n16-76,17-77\n37-95,38-94\n59-76,75-76\n79-90,26-80\n25-60,60-92\n75-77,37-76\n56-91,57-92\n25-68,67-76\n94-98,2-92\n2-94,1-3\n2-24,3-84\n58-93,92-94\n38-97,38-99\n32-95,31-33\n27-47,23-28\n73-90,61-72\n60-60,61-94\n2-51,12-51\n37-85,40-86\n98-98,17-97\n5-99,1-1\n6-16,15-75\n93-94,57-94\n78-96,77-91\n27-28,28-77\n95-97,61-96\n1-67,66-68\n80-93,11-79\n7-7,6-8\n5-93,14-89\n23-49,3-49\n10-60,19-61\n32-77,31-32\n4-50,3-4\n19-26,20-57\n18-23,22-85\n59-71,16-72\n81-99,51-82\n14-44,13-43\n46-90,24-91\n2-3,3-98\n3-99,6-97\n68-77,29-69\n94-98,30-94\n46-98,10-97\n13-75,12-74\n60-81,59-67\n16-90,15-15\n12-85,4-10\n82-99,1-98\n2-92,64-92\n75-97,1-94\n5-71,3-70\n23-63,24-64\n44-78,19-79\n60-65,60-66\n29-84,28-83\n21-86,20-28\n1-42,6-43\n30-63,30-63\n50-84,61-93\n6-74,5-73\n40-93,39-57\n1-99,1-31\n14-88,75-87\n50-83,50-50\n2-94,1-1\n24-81,23-89\n82-92,93-93\n32-84,83-98\n7-74,7-7\n34-96,96-99\n9-22,10-98\n56-95,21-57\n14-30,15-78\n11-36,35-37\n79-85,73-86\n65-68,64-67\n12-18,15-67\n42-84,41-43\n52-52,3-51\n80-82,27-81\n5-24,5-23\n38-38,39-61\n10-33,33-34\n7-83,9-82\n39-71,36-72\n82-82,2-81\n10-20,20-76\n21-71,20-20\n55-66,55-65\n2-3,4-54\n41-54,25-40\n10-25,24-26\n49-97,96-99\n9-58,9-57\n88-88,3-89\n5-94,4-93\n38-58,12-37\n1-6,31-79\n4-96,87-92\n10-62,1-61\n23-53,22-23\n6-93,6-93\n73-81,19-67\n49-50,29-50\n68-97,67-96\n23-60,44-91\n20-65,4-5\n53-82,52-53\n5-95,5-5\n45-55,27-54\n3-80,1-79\n29-38,28-28\n63-68,68-78\n13-73,10-72\n26-85,26-85\n65-98,28-60\n56-56,57-59\n21-99,14-53\n13-77,14-77\n67-99,54-68\n14-98,13-13\n54-91,55-90\n56-58,57-97\n74-88,74-88\n92-93,2-93\n2-95,1-94\n33-52,43-53\n25-64,26-88\n24-86,9-25\n13-76,5-14\n31-80,30-32\n97-99,47-98\n2-92,2-2\n6-54,2-53\n5-89,4-95\n1-76,78-78\n54-69,53-59\n20-76,21-77\n78-79,18-78\n35-96,97-97\n6-71,72-79\n1-3,2-88\n31-88,32-88\n89-91,69-90\n39-41,3-40\n28-95,94-96\n9-69,57-68\n5-89,6-88\n8-20,32-82\n62-96,63-96\n71-94,71-71\n51-80,42-62\n45-96,97-98\n15-89,89-99\n23-94,34-44\n4-64,63-63\n53-64,53-65\n16-99,4-98\n40-41,41-69\n43-95,94-95\n45-55,46-65\n17-19,2-18\n13-58,13-55\n64-90,65-91\n80-82,81-83\n5-87,88-88\n16-96,22-79\n2-61,1-59\n10-45,10-10\n46-46,46-68\n71-75,70-73\n6-8,11-84\n31-38,37-38\n16-65,16-85\n8-56,7-55\n11-36,35-37\n62-85,29-86\n46-67,66-67\n92-92,30-91\n58-66,58-63\n22-40,12-39\n57-68,57-57\n19-72,71-88\n98-98,1-97\n3-97,6-84\n37-88,23-51\n6-92,93-93\n13-86,1-86\n8-62,9-63\n15-41,14-31\n92-95,45-94\n5-13,18-87\n20-37,21-37\n8-93,99-99\n97-97,93-98\n44-73,43-72\n73-80,67-81\n23-79,23-38\n10-12,11-38\n1-14,10-56\n31-31,12-30\n32-56,56-92\n90-98,1-87\n42-72,41-72\n48-60,48-59\n68-69,70-70\n25-95,94-97\n55-55,13-54\n55-65,55-55\n5-91,3-90\n1-95,9-91\n66-66,67-80\n26-95,27-94\n3-11,2-2\n56-81,55-72\n19-84,52-91\n14-96,15-97\n4-70,3-69\n60-84,59-84\n11-34,11-33\n8-93,96-98\n50-95,49-77\n10-51,50-79\n7-35,34-34\n20-25,24-92\n25-27,26-50\n87-88,76-86\n8-85,8-25\n63-78,64-84\n95-98,70-96\n94-99,94-99\n29-92,30-92\n33-80,33-88\n67-71,68-72\n2-3,3-93\n11-71,12-72\n12-57,57-57\n3-4,4-95\n42-90,43-91\n85-86,85-98\n4-78,1-77\n6-99,6-6\n6-83,82-84\n4-79,4-79\n4-42,32-41\n80-85,4-81\n1-40,39-68\n2-78,78-79\n20-69,24-70\n36-61,37-62\n82-84,13-83\n35-36,19-35\n3-3,4-67\n12-20,21-21\n18-24,24-56\n92-94,93-95\n30-83,30-70\n4-81,2-82\n4-22,23-88\n64-64,37-63\n9-41,29-62\n48-95,69-96\n52-68,52-69\n12-81,13-82\n5-6,6-84\n14-84,15-84\n61-61,61-91\n18-26,27-31\n15-83,14-82\n46-70,7-84\n1-41,40-46\n60-62,4-61\n34-92,33-91\n38-64,39-65\n8-94,8-94\n31-84,62-97\n31-32,31-46\n69-97,40-56\n24-35,35-72\n37-85,36-84\n63-65,9-64\n34-51,35-57\n5-96,95-96\n26-86,29-86\n4-80,2-81\n53-62,53-62\n33-83,34-84\n25-82,1-7\n24-39,23-24\n67-68,68-69\n21-58,2-22\n54-61,62-68\n96-99,26-96\n26-70,2-27\n6-94,5-96\n72-88,62-87\n7-76,67-72\n67-98,60-85\n38-39,39-91\n7-23,7-10\n22-60,21-59\n3-3,4-93\n9-66,33-53\n53-76,54-76\n23-85,6-98\n82-88,82-88\n42-78,15-84\n54-78,59-79\n8-99,7-9\n5-94,6-94\n32-32,32-80\n23-52,24-53\n38-88,38-87\n3-54,2-2\n56-74,56-73\n15-15,16-57\n6-62,5-6\n40-40,39-87\n1-77,10-77\n60-95,1-60\n99-99,71-83\n18-35,45-69\n55-83,48-86\n33-33,18-32\n15-61,92-97\n15-69,42-70\n37-74,38-75\n62-98,62-97\n4-70,15-57\n56-56,55-55\n8-94,93-95\n62-64,63-75\n59-67,68-68\n1-91,3-92\n55-69,54-54\n6-81,80-88\n59-61,15-60\n42-96,8-79\n81-84,34-71\n57-59,60-60\n12-95,12-81\n67-67,61-66\n9-31,30-47\n4-52,42-98\n72-87,1-73\n74-99,73-99\n8-30,10-95\n3-97,3-98\n12-16,17-92\n87-94,13-86\n15-50,51-51\n6-46,45-45\n71-71,70-70\n31-93,30-30\n20-21,20-74\n4-75,2-89\n31-74,31-31\n6-26,22-23\n46-87,47-88\n58-77,59-76\n75-75,71-76\n95-97,10-96\n6-11,6-27\n86-87,37-88\n13-17,14-16\n56-76,10-77\n9-88,5-7\n93-95,2-94\n29-61,29-61\n42-82,41-83\n2-14,3-98\n46-91,46-91\n57-74,57-74\n10-57,73-83\n13-31,5-94\n48-85,33-49\n48-89,88-89\n4-98,2-5\n7-85,6-84\n48-75,82-89\n54-77,53-77\n25-90,24-43\n92-94,15-91\n46-81,78-78\n8-89,88-90\n20-78,13-21\n22-28,21-26\n5-87,88-88\n5-94,95-95\n37-43,42-88\n52-52,53-55\n30-76,29-30\n53-88,40-61\n6-82,81-83\n94-96,17-94\n2-92,69-92\n15-80,80-81\n19-90,39-89\n87-99,87-99\n32-86,33-87\n58-87,57-82\n6-74,5-73\n3-17,17-82\n51-69,50-62\n64-68,19-69\n40-92,91-92\n3-93,2-75\n11-94,10-94\n78-98,97-99\n18-70,71-98\n58-87,67-93\n29-57,22-58\n18-35,19-88\n86-95,14-86\n6-37,27-36\n53-65,36-52\n10-95,25-94\n22-60,95-96\n52-79,53-80\n9-38,8-9\n39-54,27-44\n25-98,88-99\n10-90,9-10\n14-48,13-47\n11-38,12-51\n38-55,25-38\n45-55,46-54\n16-89,22-90\n10-56,55-65\n64-88,86-87\n4-28,27-82\n21-75,21-41\n9-11,10-94\n17-86,2-16\n6-51,46-50\n92-93,92-93\n16-47,28-49\n54-58,34-57\n36-50,91-95\n40-44,38-43\n57-96,56-95\n20-30,29-30\n26-92,16-31\n3-79,2-78\n27-74,68-73\n38-43,39-75\n4-64,5-65\n14-62,10-94\n6-21,5-26\n12-12,12-61\n86-86,66-87\n21-47,36-54\n45-81,43-46\n9-63,64-78\n53-55,1-54\n38-52,47-71\n26-29,25-28\n5-92,71-82\n22-81,22-80\n59-93,58-93\n2-11,10-96\n19-24,29-45\n10-98,9-9\n19-45,13-19\n16-83,17-84\n14-46,32-41\n31-90,45-89\n3-98,2-98\n67-91,56-68\n21-90,10-90\n21-41,21-33\n1-3,2-99\n31-78,78-89\n4-23,22-23\n7-92,4-91\n9-75,9-76\n30-35,34-95\n17-90,17-89\n11-54,10-11\n13-87,12-39\n12-59,15-60\n14-89,89-90\n3-98,64-95\n23-99,14-90\n3-3,3-94\n32-77,73-78\n12-14,13-95\n34-66,61-64\n43-49,62-79\n87-87,21-86\n11-30,36-72\n62-62,23-63\n63-86,36-62\n31-35,26-30\n32-98,13-33\n29-59,28-30\n14-92,9-15\n50-65,49-64\n7-49,7-49\n17-17,16-18\n7-13,8-14\n94-98,56-91\n34-72,33-34\n14-87,61-88\n65-65,44-78\n30-31,32-32\n11-51,10-11\n35-82,34-35\n87-90,4-88\n49-53,15-49\n1-3,2-94\n67-87,18-68\n16-71,6-17\n66-85,79-86\n77-86,59-78\n12-38,13-60\n17-37,16-38\n25-80,26-81\n50-95,96-98\n64-66,6-65\n60-69,48-68\n1-63,2-64\n20-94,95-95\n31-59,66-94\n45-93,12-87\n11-33,16-58\n48-97,47-96\n27-86,28-87\n21-25,21-57\n44-46,45-47\n23-44,22-44\n44-82,10-45\n9-91,9-92\n48-80,47-74\n47-49,29-48\n18-36,9-27\n16-93,92-95\n39-80,24-88\n16-99,62-97\n6-66,4-7\n91-98,31-90\n47-86,46-87\n16-88,15-84\n59-80,21-79\n92-98,6-88\n4-43,18-44\n10-58,1-1\n19-94,3-97\n2-73,4-74\n15-23,75-76\n92-99,21-93\n13-14,14-89\n27-95,63-95\n69-92,70-94\n7-73,6-35\n15-87,44-88\n28-81,82-95\n61-94,60-61\n41-45,42-70\n17-76,16-75\n20-91,19-38\n1-62,4-49\n59-59,4-58\n25-27,26-92\n34-78,33-63\n29-71,51-72\n49-74,48-49\n33-94,34-95\n7-15,16-60\n27-75,28-75\n5-6,6-73\n4-4,5-90\n21-23,6-22\n30-93,30-93\n28-74,12-18\n24-77,78-78\n58-69,68-70\n2-89,1-89\n71-75,76-76\n13-35,34-34\n16-94,17-95\n31-41,77-86\n27-76,26-35\n9-44,12-45\n44-46,9-45\n8-88,7-7\n74-75,60-75\n33-56,48-72\n11-82,10-10\n2-95,94-96\n37-52,54-58\n12-32,12-32\n2-68,2-69\n2-12,11-32\n3-7,8-90\n24-24,25-47\n46-47,47-55\n25-78,25-25\n41-47,40-41\n92-93,12-92\n87-88,88-90\n8-52,13-59\n25-86,25-86\n40-52,40-52\n98-99,72-86\n6-90,12-91\n4-7,6-65\n41-89,88-96\n29-83,84-90\n3-82,1-90\n19-35,25-34\n27-99,27-99\n30-72,31-73\n28-30,8-29\n5-95,5-94\n16-94,20-93\n11-61,61-63\n2-4,79-80\n78-80,9-79\n81-83,12-81\n41-46,45-89\n8-68,3-6\n70-72,69-72\n3-87,4-86\n6-99,5-98\n68-85,69-92\n7-11,84-98\n59-69,58-68\n18-73,17-17\n10-90,91-98\n88-93,89-94\n17-17,18-32\n1-63,2-63\n78-78,44-77\n47-90,89-91\n32-74,33-75\n37-38,37-87\n5-80,4-79\n94-95,19-95\n53-63,52-63\n52-70,28-51\n42-95,43-89\n89-93,29-92\n81-98,70-89\n27-85,28-93\n36-72,20-37\n83-87,82-82\n36-77,36-78\n28-54,27-28\n61-76,77-77\n67-71,66-71\n53-77,70-78\n73-77,64-78\n24-81,11-25\n1-2,11-87\n66-74,66-75\n6-7,7-93\n7-37,38-78\n35-89,34-86\n45-72,34-72\n27-95,26-71\n27-78,26-27\n8-96,4-97\n15-70,7-11\n24-92,15-25\n16-45,44-50\n27-79,14-78\n30-33,32-95\n21-55,44-56\n58-97,2-96\n91-97,92-97\n9-13,77-82\n19-90,18-89\n15-90,16-93\n15-18,29-69\n30-41,40-42\n67-80,76-82\n39-65,2-97\n17-95,18-95\n27-88,6-89\n48-74,47-73\n62-93,63-94\n4-61,4-60\n32-91,33-91\n8-91,51-92\n1-99,1-99\n3-64,2-65\n12-58,4-57\n6-36,37-37\n43-59,17-58\n94-99,93-93\n37-61,36-60\n4-8,5-16\n23-25,34-88\n26-49,25-48\n21-21,21-62\n9-83,10-84\n7-90,6-7\n71-97,71-98\n88-99,85-97\n94-98,15-86\n38-61,39-71\n2-87,4-80\n28-87,18-18\n1-88,7-85\n17-87,16-88\n78-88,53-78\n19-45,46-66\n30-87,23-29\n6-73,7-74\n8-69,68-70\n42-70,41-49\n11-60,12-61\n28-86,85-92\n18-79,14-78\n4-91,2-90\n82-93,82-96\n50-86,33-49\n96-98,29-95\n31-35,27-34\n90-93,43-91\n35-35,26-34\n7-67,34-68\n24-72,23-73\n12-96,12-97\n61-68,51-83\n93-95,24-94\n73-92,11-84\n38-81,16-82\n20-76,19-75\n1-4,3-96\n82-85,82-86\n41-57,46-56\n22-22,19-24\n2-97,98-98\n96-96,28-95\n4-58,3-39\n35-86,28-85\n5-80,64-81\n81-92,82-93\n4-79,3-4\n5-26,27-53\n19-75,3-4\n80-81,54-81\n6-9,8-90\n1-97,13-98\n57-57,41-56\n3-88,44-89\n16-53,15-52\n24-84,25-83\n17-76,16-54\n22-72,23-96\n78-79,66-79\n21-35,2-22\n1-89,10-90\n97-98,98-98\n27-98,28-99\n1-79,2-97\n88-88,5-82\n51-86,49-51\n20-87,21-86\n99-99,52-79\n56-58,1-57\n71-74,70-70\n22-51,51-77\n55-92,54-91\n63-99,6-93\n42-88,41-87\n44-53,44-52\n19-59,23-67\n10-76,5-41\n49-64,63-65\n32-64,17-63\n1-2,3-99\n29-75,28-29\n98-98,31-97\n63-84,64-85\n40-85,39-84\n30-46,45-69\n1-25,3-99\n48-98,49-99\n5-40,23-41\n78-79,50-79\n9-10,10-10\n37-65,37-65\n16-22,17-35\n47-82,46-47\n14-67,13-14\n32-93,11-56\n65-93,66-94\n20-80,21-80\n92-94,3-89\n67-68,16-68\n12-97,97-99\n2-16,19-95\n8-32,31-35\n98-98,76-95\n8-57,8-58\n10-25,11-25\n23-33,34-66\n12-69,12-23\n10-68,9-69\n42-50,31-51\n27-81,28-80\n7-99,8-99\n5-88,5-87\n39-84,7-85\n2-61,74-88\n4-56,4-55\n47-60,48-79\n19-47,46-93\n35-93,34-92\n64-96,64-96\n28-28,28-34\n54-91,92-92\n15-27,27-27\n17-79,27-50\n1-3,2-88\n14-97,96-96\n19-66,42-67\n87-94,37-49\n15-82,87-98\n8-26,8-49\n43-43,50-99\n55-98,25-97\n5-82,6-83\n29-53,47-48\n10-92,9-10\n33-43,13-71\n9-79,10-79\n30-63,31-75\n2-54,1-2\n37-95,21-96\n68-79,16-69\n2-47,46-47\n45-65,5-44\n21-99,28-96\n4-31,4-52\n16-94,8-96\n13-86,85-88\n58-76,53-56\n7-95,30-96\n96-96,28-78\n24-55,23-54\n30-84,30-83\n21-82,7-81\n9-35,36-90\n3-17,1-2\n1-1,2-37\n4-99,4-99\n38-65,37-45\n94-95,31-78\n58-95,94-97\n30-95,29-95\n70-81,76-98\n15-76,21-65\n6-59,5-59\n8-28,7-21\n43-61,62-63\n10-30,10-30\n10-85,10-85\n21-40,22-40\n24-60,29-61\n51-86,13-52\n6-96,5-96\n6-18,17-55\n24-24,24-24\n81-95,96-99";
}

